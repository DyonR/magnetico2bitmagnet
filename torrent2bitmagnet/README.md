# torrent2bitmagnet

`torrent2bitmagnet` processes a directory (recursively) with .torrent files in it to extract and print data in a bitmagnet supported JSON format.

## Requirements

**bencodepy**:
`pip install bencodepy` or `pip3 install bencodepy`

## Usage

To run the script, use the following command:

```bash
python3 torrent2bitmagnet.py <directory_path>
```

### Command-line Arguments

- `<directory_path>`: The path to the directory containing .torrent files.
- `-o`, `--output`, `--to-file`: Exports the JSON output to a file specified by this argument.
- `-s`, `--split-size`: Splits the output into multiple files after a specified number of records. Requires `--output` to be set.
- `--source`: "Torrent Source" how it will appear in bitmagnet, default is ".torrent".
- `-r`, `--recursive`: Recursively find .torrent files in subdirectories of the <directory_path>.
- `--auto-create-dir`: Automatically creates the output directory if it does not exist, without prompting.
- `--negative-to-zero`: Rarely a bad .torrent can report a negative size. Set this argument to set the size to "0" to allow importing them.
- `-v`, `--version`: Displays the script's version.
- `-h`, `--help`: Shows the help message.

### Examples

Run the script with a specified directory path:
```bash
python3 torrent2bitmagnet.py /path/to/directory/with/torrent/files
```

Run the script, export the output, and limit the contents of a file to `100000`:
```bash
python3 torrent2bitmagnet.py /path/to/directory/with/torrent/files --output /path/to/your/output/torrent_files.json --split-size 100000
```

### Importing to bitmagnet
There are two ways to import, directly by piping the output into `curl`, or by using the files generated by enabling `--output`.
To import data to bitmagnet, the `/import` endpoint of bitmagnet must be utlized.  

#### Directly
Run the command below, replacing `/path/to/directory/with/torrent/files` with the path to your directory and `192.168.2.0:3333` with your bitmagnet instance's IP address and port, or hostname and port.

```bash
python3 torrent2bitmagnet.py /path/to/directory/with/torrent/files | curl --verbose -H "Content-Type: application/json" -H "Connection: close" --data-binary @- http://192.168.2.0:3333/import
```

#### (Separate) File(s)
First, `cd` to the directory with the output file(s).  
Run the command below, replacing `192.168.2.0:3333` with your bitmagnet instance's IP address and port, or hostname and port.  
If you didn't set `.json` as extension, you can remove that from the command.

```bash
for i in *.json; do cat "$i" | curl --verbose -H "Content-Type: application/json" -H "Connection: close" --data-binary @- http://192.168.2.0:3333/import; done
```

**Note**: Importing millions of records may use **a lot of RAM** and will also take a really long time to import. This can take **hours**.  
After importing, bitmagnet will also classify all imported torrents before they appear in the WebUI. This can take **multiple days**.
